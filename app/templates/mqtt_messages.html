{% extends "base.html" %}

{% block page_title %}MQTT â€” View Messages{% endblock %}

{% block header_actions %}{% endblock %}

{% block content %}

<div class="card" style="height: calc(100vh - 148px); display: flex; flex-direction: column;">
    <div class="card-header d-flex justify-content-between align-items-center" style="flex-shrink:0;">
        <div class="d-flex align-items-center gap-2">
            <span><i class="bi bi-terminal"></i> Live Messages</span>
            <span id="tail-topic" class="tail-topic-badge" style="display:none;"></span>
        </div>
        <div class="d-flex align-items-center gap-2">
            <span id="tail-status" class="tail-status-label"></span>
            <button class="btn btn-sm btn-outline-secondary" id="btn-clear-messages" title="Clear messages">
                <i class="bi bi-trash"></i> Clear
            </button>
            <button class="btn btn-sm btn-outline-secondary" id="btn-tail-toggle">
                <i class="bi bi-play-fill"></i> Start
            </button>
        </div>
    </div>
    <div class="card-body p-0" style="flex:1; min-height:0; display:flex; flex-direction:column;">
        <div id="tail-container" class="tail-container"
             style="flex:1; min-height:0; max-height:none; overflow-y:auto;">
            <div id="tail-empty" class="tail-empty">
                <i class="bi bi-terminal" style="font-size: 1.5rem; opacity: 0.3;"></i>
                <div>Click <strong>Start</strong> to subscribe to broker messages</div>
                <div style="font-size:0.75rem; opacity:0.5; margin-top:4px;">Auto-stops after 5 minutes</div>
            </div>
            <div id="tail-messages"></div>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/mqtt_messages.js') }}"></script>
{% endblock %}
